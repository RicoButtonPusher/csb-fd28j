(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,n){e.exports=n(42)},41:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(23),c=n.n(o),i=n(5),s=(n(28),n(30),n(31),n(6)),l=n(13),u=function(e){var t=Object.keys(e.seats_by_rows);return 15*Math.max.apply(Math,Object(l.a)(t.map(function(t){return Object.keys(e.seats_by_rows[t]).length})))+60},d=function(e){return 15*Object.keys(e.seats_by_rows).length+60},f=function(e){return e.subsections.reduce(function(e,t){return e+u(t)},0)};function h(e,t){return t?"red":e?"lightgrey":"#1b728d"}var m=function(e){var t="booked"===e.data.status;return r.a.createElement(s.Circle,{x:e.x,y:e.y,radius:5,fill:h(t,e.isSelected),strokeWidth:1,onMouseEnter:function(n){n.target._clearCache(),e.onHover(e.data.name,n.target.getAbsolutePosition());var a=n.target.getStage().container();a.style.cursor=t?"not-allowed":"pointer"},onMouseLeave:function(t){e.onHover(null),t.target.getStage().container().style.cursor=""},onClick:function(n){t||(e.isSelected?e.onDeselect(e.data.name):e.onSelect(e.data.name))},onTap:function(n){t||(e.isSelected?e.onDeselect(e.data.name):e.onSelect(e.data.name))}})},g=function(e){var t=e.width,n=e.x,a=e.y,o=e.data,c=e.onHoverSeat,i=e.onSelectSeat,l=e.onDeselectSeat,u=e.selectedSeatsIds;return r.a.createElement(s.Group,{x:n,y:a},Object.keys(o.seats_by_rows).map(function(e,t){var n=o.seats_by_rows[e];return r.a.createElement(r.a.Fragment,{key:e},n.map(function(e,n){return r.a.createElement(m,{key:e.name,x:15*n+30,y:15*t+30,data:e,onHover:c,onSelect:i,onDeselect:l,isSelected:u.indexOf(e.name)>=0})}),r.a.createElement(s.Text,{text:e,x:15,y:15*t+30-5,fontSize:10,key:"label-left"+e}))}),o.seats_by_rows[1].map(function(e,t){return r.a.createElement(s.Text,{text:(t+1).toString(),x:15*t+30-50,width:100,y:15*Object.keys(o.seats_by_rows).length+30,key:"label-bottom"+t,align:"center"})}),r.a.createElement(s.Text,{text:o.name,width:t,align:"center",y:-10}))},y=r.a.memo(function(e){var t=e.section,n=e.height,a=e.x,o=e.y,c=e.onHoverSeat,i=e.onSelectSeat,l=e.onDeselectSeat,d=e.selectedSeatsIds,h=r.a.useRef();r.a.useEffect(function(){h.current.cache(),h.current.getLayer().batchDraw()},[t,d]);var m=f(t),y=0;return r.a.createElement(s.Group,{y:o,x:a,ref:h},r.a.createElement(s.Rect,{width:m,height:n,fill:"white",strokeWidth:1,stroke:"lightgrey",cornerRadius:5}),t.subsections.map(function(e){var t=u(e),a=y;return y+=t,r.a.createElement(g,{x:a,y:40,key:e.name,data:e,width:t,height:n,onHoverSeat:c,onSelectSeat:i,onDeselectSeat:l,selectedSeatsIds:d})}),r.a.createElement(s.Text,{text:t.name,height:40,width:m,align:"center",verticalAlign:"middle",fontSize:20}))}),b=function(e){var t=e.position,n=e.seatId,a=e.onClose,o=r.a.useRef(null);return r.a.useEffect(function(){var e=function(e){(function(e,t){for(var n=e.target;n;){if(n===t)return!0;n=n.parentNode}return!1})(e,o.current)||a()};return window.addEventListener("click",e),function(){window.removeEventListener("click",e)}},[]),r.a.createElement("div",{ref:o,style:{position:"absolute",top:t.y+20+"px",left:t.x+20+"px",padding:"10px",borderRadius:"3px",boxShadow:"0 0 5px grey",zIndex:10,backgroundColor:"white"}},r.a.createElement("div",null,"Seat ",n),r.a.createElement("div",null,"Click on the seat to select"))},v=function(e){var t=function(e){var t=r.a.useState(null),n=Object(i.a)(t,2),a=n[0],o=n[1];return r.a.useEffect(function(){fetch(e).then(function(e){return e.json()}).then(function(e){return o(e)})},[e]),a}("./seats-data.json"),n=r.a.useRef(null),a=r.a.useRef(null),o=r.a.useState(1),c=Object(i.a)(o,2),u=c[0],h=c[1],m=r.a.useState(1),g=Object(i.a)(m,2),v=g[0],S=g[1],p=r.a.useState({width:1e3,height:1e3,virtualWidth:1e3}),w=Object(i.a)(p,2),x=w[0],E=w[1],k=r.a.useState(1e3),j=Object(i.a)(k,2),O=j[0],_=j[1],C=r.a.useState([]),M=Object(i.a)(C,2),D=M[0],H=M[1],I=r.a.useState({seat:null}),R=Object(i.a)(I,2),T=R[0],L=R[1];r.a.useEffect(function(){var e={width:n.current.offsetWidth,height:n.current.offsetHeight};e.width===x.width&&e.height===x.height||E(e)}),r.a.useEffect(function(){if(a.current){var e=a.current.getClientRect({skipTransform:!0}),t=x.width/e.width;h(t),S(t),_(e.width)}},[t,x]);var W=r.a.useCallback(function(){h(1===u?v:1)},[u,v]),z=0,A=r.a.useCallback(function(e,t){L({seat:e,position:t})},[]),B=r.a.useCallback(function(e){var t=D.concat([e]);H(t)},[D]),F=r.a.useCallback(function(e){var t=D.slice();t.splice(t.indexOf(e),1),H(t)},[D]);if(null===t)return r.a.createElement("div",{ref:n},"Loading...");var G,J=(G=t.seats.sections,Math.max.apply(Math,Object(l.a)(G.map(f))));return r.a.createElement("div",{style:{position:"relative",backgroundColor:"lightgrey",width:"100vw",height:"100vh"},ref:n},r.a.createElement(s.Stage,{ref:a,width:x.width,height:x.height,draggable:!0,dragBoundFunc:function(e){return e.x=Math.min(x.width/2,Math.max(e.x,-O*u+x.width/2)),e.y=Math.min(x.height/2,Math.max(e.y,-x.height/2)),e},onDblTap:W,onDblClick:W,scaleX:u,scaleY:u},r.a.createElement(s.Layer,null,t.seats.sections.map(function(e,t){var n=function(e){return Math.max.apply(Math,Object(l.a)(e.subsections.map(d)))+40}(e),a=z+10;z=a+n;var o=f(e),c=(J-o)/2;return r.a.createElement(y,{x:c,y:a,height:n,key:t,section:e,selectedSeatsIds:D,onHoverSeat:A,onSelectSeat:B,onDeselectSeat:F})}))),T.seat&&r.a.createElement(b,{position:T.position,seatId:T.seat,onClose:function(){L({seat:null})}}))};n(41);function S(){return r.a.createElement(v,{onSelectSeat:function(e){console.log("selected - "+e)}})}var p=document.getElementById("root");c.a.render(r.a.createElement(S,null),p)}},[[24,1,2]]]);
//# sourceMappingURL=main.b28638e5.chunk.js.map